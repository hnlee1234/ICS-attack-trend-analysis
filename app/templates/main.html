{% load mptt_tags %}
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">

CAPEC_MITRE
<br><br><br>

<!--
<form action = '^create/' method="post">
    "create라는 함수에 signal을 url경로를 포함하여 전달, 추후 urls.py와 views.py에서 처리해야함"
    {% csrf_token %}
        <button name="create" value="True">Create (ONLY for new crawling!!)</button>
</form>
--!>
<button onclick="window.location='products';">Products</button>
<br>


<div class = "table-responsive">
	<table class="table table-bordered">
		<tr>
			{% for category, count in counts.items %}
				{% if count.1 == 0 %}
					<th colspan = "70%">{{ category }}</th>
					<td>{{ count.0 }}</td>
				{% endif %}
			{% endfor %}
		</tr>
		<tr>
			{% for category, count in counts.items %}
				{% if count.1 == 1 %}
					<th>{{ category }}</th>
					<td>{{ count.0 }}</td>
				{% endif %}
			{% endfor %}
		</tr>
		<tr>
			{% for category, count in counts.items %}
				{% if count.1 == 2 %}
					<th>{{ category }}</th>
					<td>{{ count.0 }}</td>
				{% endif %}
			{% endfor %}
		</tr>
		<tr>
			{% for category,count in counts.items %}
				{% if count.1 > 2 %}
					<th>{{ category }}</th>
					<td>{{ count.0 }}</td>
				{% endif %}
			{% endfor %}		
		</tr>
	</table>
</div>


<ul>
    {% recursetree vulners %}
        <li>
            {% if '-' not in node.id %}
                <b>{{ node.name }}</b>
              	<b>({{ node.id }})</b>
              	<b>{{ node.severity }}</b>
            {% else %}
                {{ node.name }}
                ({{ node.id }})
                {{ node.severity }}
            {% endif %}
            {% if not node.is_leaf_node %}
                <ul class="children">
                    {{ children }}
                </ul>
            {% endif %}
        </li>
    {% endrecursetree %}
</ul>
